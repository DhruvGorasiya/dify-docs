---
title: 二段階認証
---

## 紹介

多くの企業では大量の機密ユーザー情報が扱われています。二段階認証は、Dify エンタープライズシステム管理者アカウントにより安全なセキュリティを提供できます。この機能を有効化後、元のパスワードが誤って漏洩しても、不正アクセス操作を防ぐことができ、システム管理者アカウントと企業の保持するデータのセキュリティを確保します。

この機能では、ユーザーが正しいパスワードを入力した後、認証アプリケーションで生成されたリアルタイム認証コードを入力してログインを完了する必要があります。この「二要素」認証により、アカウントセキュリティが大幅に向上します。

## 実装前提条件

二段階認証を設定する前に、以下の条件を満たしていることを確認してください：

1. **システム管理者権限** - システム管理者のみが二段階認証を設定できます。
2. **認証アプリケーション** - モバイルデバイスに互換性のある認証アプリケーションをインストールしてください。

<Info>
認証アプリケーション（[Google Authenticator](https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2) など）は TOTP（Time-based One-Time Password）標準に基づいており、30秒ごとに新しい認証コードを生成します。
</Info>

## 二段階認証を有効化

チーム全体の二段階認証を有効化する前に、個人アカウントで二段階認証が設定されていることを確認してください。

### 個人アカウント

個人の二段階認証を設定する手順：

<Steps>
  <Step title="管理バックエンドにアクセス">
    Dify エンタープライズ管理バックエンドにログインします。
  </Step>
  <Step title="二段階認証設定を開く">
    サイドバーメニューで「二段階認証」オプションをクリックします。
  </Step>
  <Step title="認証器を設定">
    認証器セクションを見つけ、右側の「設定」ボタンをクリックします。
  </Step>
  <Step title="QR コードをスキャン">
    認証アプリケーションを使用して表示された QR コードをスキャンします。
  </Step>
  <Step title="認証コードを入力">
    認証アプリケーションに表示された6桁の認証コードを認証ボックスに入力して設定を完了します。
  </Step>
</Steps>

QR コードをスキャンできない場合は、**Setup Key** にマウスを置いてキーテキストを表示してください。これを認証アプリに入力して6桁の認証コードを生成し、生成された認証コードを認証ボックスに入力してください。

![](https://assets-docs.dify.ai/2025/04/fd6b474384081f4079aa453c45c07562.png)

二段階認証を有効化後、同時にバックアップコードが生成されます。認証アプリのあるデバイスの紛失によりオンライン認証コードを取得できない状況を避けるため、バックアップコードを安全な場所に手書きまたは印刷することをお勧めします。

![](https://assets-docs.dify.ai/2025/04/2c88c1492bf9a079df9ad4a25e1923ac.png)

バックアップコードは一回限りの使用で、使用済みのバックアップコードは無効になります。より多くのバックアップコードが必要な場合は、「再生成」をクリックしてください。

![](https://assets-docs.dify.ai/2025/04/8313cf497c66cfef7dee2a4ae816c32b.png)

### 企業全体

> すべてのシステム管理者は、企業全体の二段階認証を有効化する権限を持っています。企業全体の認証を有効化する前に、個人の二段階認証を有効化する必要があります。

**設定** → **アイデンティティ認証** に移動して企業全体の二段階認証を有効化します。有効化後、各システム管理者は企業管理バックエンドにログインする際に追加の認証コードを提供する必要があります。システム管理者がまだ二段階認証を設定していない場合は、[よくある問題](#グローバル強制二段階認証を有効化後-個人アカウント二段階認証を有効化していない管理者はどのようにログインしますか)を参照してください。

![](https://assets-docs.dify.ai/2025/04/1271b3b0e39558465dbb79b17d1a9721.png)

## 二段階認証を変更

企業管理バックエンドにアクセスし、「二段階認証」をクリックし、認証器の右側のメニューオプションで「編集」ボタンをクリックします。ポップアップ認証ページで、認証アプリが表示する新しい6桁の認証コードを入力してアイデンティティを確認し、変更を完了します。

## 二段階認証を無効化

<Warning>
二段階認証を無効化すると、追加のセキュリティ層が削除され、アカウントはパスワード保護のみに依存するようになり、不正アクセスのリスクが大幅に増加します。
</Warning>

### 個人アカウント

> 企業バックエンドで全ユーザーに対して二段階認証の強制をしている場合、個人アカウントの二段階認証は無効化できません。

企業管理バックエンドにアクセスし、「二段階認証」→「二段階認証を無効化」をクリックします。

### 企業全体

企業管理バックエンドにアクセスし、**「設定」→「アイデンティティ認証」** をクリックして二段階認証ボタンを無効にします。

<Note>
    二段階認証を有効化、変更、または無効化する際、システム管理者はメールで対応する通知を受け取ります。
</Note>

## よくある問題

### 認証アプリが入っているデバイスを紛失しました。どのようにログインすればよいですか？

元のデバイスを忘れたり紛失したりした場合は、以下の方法でログインしてください：

1. **バックアップコードを使用してログイン**：ログインページで「バックアップコードを使用」オプションを選択し、以前に保存したバックアップコードを入力します。各バックアップコードは一回のみ使用可能です。
2. **他のシステム管理者に連絡**：バックアップコードがない場合は、チーム内の他のシステム管理者に連絡して一時的なアクセスまたは二段階認証設定のリセット支援を要請してください。

### 二段階認証コードは正しいのにシステムでエラーが表示されます。どのように解決しますか？

認証コードエラーには通常以下の原因があります：

1. **時刻が同期されていない**：認証器は時刻に基づいて認証コードを生成するため、デバイスの時刻が標準時刻と同期していることを確認してください。ほとんどのスマートフォンは自動的に時刻を同期しますが、自動同期を無効にしている場合は、デバイス設定で有効化してください。
2. **認証コードが期限切れ**：認証器の認証コードは通常30秒ごとに更新されます。期限切れ直前にコードを入力すると無効になる可能性があります。新しい認証コードの生成を待ってから再試行してください。
3. **デバイスとアカウントの不一致**：正しい認証器と正しいアカウントを使用して認証コードを生成していることを確認してください。

### 携帯電話を変更後、認証器をどのように移行しますか？

アプリケーションを移行する方法は2つあります：

1. **アプリ内移行機能を使用**：一部の認証アプリ（最新版の Google Authenticator など）はアカウントエクスポート/インポート機能を提供しており、新しいデバイスに認証アプリの情報を移行できます。
2. **二段階認証をリセット**：
   - バックアップコードを使用してシステムにログイン。
   - [二段階認証を変更](#二段階認証を変更)を参照し、個人の二段階認証設定ページに移動し、「編集」をクリック。
   - 新しいデバイスで生成された認証コードを使用して認証を完了。

### 全ユーザーの二段階認証の強制を有効化後、個人アカウントで二段階認証を有効化していない管理者はどのようにログインしますか？

全ユーザーの二段階認証の強制が有効化されている場合、二段階認証を有効化していない管理者のログインプロセスは以下の通りです：

1. 新しい管理者はメールアドレスとパスワード（または SSO）を使用してシステムにログイン。
2. システムは管理者が二段階認証を設定していないことを自動的に検出し、企業ログインページで二段階認証操作ガイダンスを提供。
3. 新しい管理者は認証アプリケーションをダウンロードし、ページの指示に従って二段階認証設定を完了する必要があります。
4. 設定完了後、6桁の認証コードを入力すると、新しい管理者は企業バックエンドに継続してログインできます。
