---
title: コンテナレジストリ
---

> このページは先行公開版です。内容は今後予告なく更新される可能性があります。

## Helm チャートの値を表示

```bash
helm show values dify/dify
```

イメージのリポジトリやタグをカスタマイズするには、以下のように `values.yaml` を修正してください：

```yaml
api:
  image:
    repository: langgenius/dify-api
    tag: "x.x.x"
  ... ...
```

---

## プライベートレジストリへのイメージ同期

Dify のコンテナイメージは、**AMD64** および **ARM64** アーキテクチャの両方に対応しています。以下のスクリプトを使って、プライベートレジストリへイメージを同期することができます。

### 1. 以下のスクリプトを `sync.sh` として保存

```bash
#!/bin/bash

# 以下の環境変数を設定してください
REGISTRY_URL="xxxx"
NAMESPACE="xxx"
BASE_IMAGE=langgenius/$IMAGE:$VERSION

echo "BASE_IMAGE: $BASE_IMAGE"

# 引数の確認
if [ -z "$1" ] || [ -z "$2" ]; then
    echo "使用方法: $0 <image> <version>"
    exit 1
fi

IMAGE=$1
VERSION=$2

TARGET_IMAGE_FOR_AMD64=$REGISTRY_URL/$NAMESPACE/$IMAGE:$VERSION-amd64
echo "TARGET_IMAGE_FOR_AMD64: $TARGET_IMAGE_FOR_AMD64"

TARGET_IMAGE_FOR_ARM64=$REGISTRY_URL/$NAMESPACE/$IMAGE:$VERSION-arm64
echo "TARGET_IMAGE_FOR_ARM64: $TARGET_IMAGE_FOR_ARM64"

TARGET_IMAGE=$REGISTRY_URL/$NAMESPACE/$IMAGE:$VERSION
echo "TARGET_IMAGE: $TARGET_IMAGE"

docker pull --platform linux/amd64 $BASE_IMAGE
docker tag $BASE_IMAGE $TARGET_IMAGE_FOR_AMD64
docker push $TARGET_IMAGE_FOR_AMD64

docker pull --platform linux/arm64 $BASE_IMAGE
docker tag $BASE_IMAGE $TARGET_IMAGE_FOR_ARM64
docker push $TARGET_IMAGE_FOR_ARM64

docker manifest create $TARGET_IMAGE --amend $TARGET_IMAGE_FOR_AMD64 --amend $TARGET_IMAGE_FOR_ARM64
docker manifest push $TARGET_IMAGE
```

---

### 2. スクリプト内の変数を設定

`sync.sh` ファイル内の以下の変数を、ご利用の環境に合わせて編集してください：

* `REGISTRY_URL`：プライベートレジストリの URL
* `NAMESPACE`：プライベートレジストリ内の名前空間
* `BASE_IMAGE`（任意）：同期対象のベースイメージ（初期値：`langgenius/$IMAGE:$VERSION`）

---

### 3. 実行権限を付与

```bash
chmod +x ./sync.sh
```

---

### 4. スクリプトを実行してイメージを同期

```bash
# 使用例:
./sync.sh dify-api x.x.x
```
