---
title: オフラインデプロイメントガイド
---

> このページは先行公開版です。内容は今後予告なく更新される可能性があります。

## オフラインデプロイメント

オフライン環境では、以下2つのケースのネットワーク設定のどちらでもDifyをデプロイできます。

1. **ホワイトリストを許可する**ケース
2. **完全にネットワークから隔離されている**ケース

以下の手順でDifyをデプロイしてください。

## ホワイトリストドメイン
ホワイトリストを設定する場合、以下のドメインがアクセス可能であることを確認してください。
- https://marketplace.dify.ai
- https://pypi.org

## マーケットプレイスアクセスの無効化

外部リクエストの失敗による問題を回避するため、マーケットプレイスへの接続を無効化します。

```yaml
  marketplace:
    enabled: false # マーケットプレイスアクセスを無効化
    url: "https://marketplace.dify.ai"
    apiUrl: "https://marketplace.dify.ai"
```

## カスタムイメージリポジトリの設定

ネットワークが `docker.io` にアクセスできない場合は、デフォルトのイメージリポジトリの代わりにカスタムイメージリポジトリを使用できます。

```yaml
plugin_connector:
  gatewayImage: "nginx:1.27.3"
  shaderImage: "gcr.io/kaniko-project/executor:latest"
  busyBoxImage: "busybox:latest"
  awsCliImage: "amazon/aws-cli:latest"
  generatorConf: |
    generator:
      repo: langgenius
      python:
        pipMirror: ""
        preCompile: true
        versions:
          python3.13:
            langgenius: docker.io/langgenius/plugin-build-base-python:3.13
          python3.12:
            langgenius: docker.io/langgenius/plugin-build-base-python:3.12
          python3.11:
            langgenius: docker.io/langgenius/plugin-build-base-python:3.11
          python3.10:
            langgenius: docker.io/langgenius/plugin-build-base-python:3.10
```

1. プライベートイメージに置き換える必要があるイメージは以下のとおりです。
   - `gatewayImage`：プラグインゲートウェイサービスのイメージ
   - `shaderImage`：プラグインビルド時に使用するシェーダーイメージ
   - `busyBoxImage`：プラグイン実行時に使用する Busybox イメージ
   - `awsCliImage`：AWS CLIツールのイメージ（AWSを使用しない場合は無視して構いません）
   - `python3.xx`：プラグインのビルドに使用するベースイメージ

2. `pipMirror` をカスタムのミラーソースURLに置き換えてください。

3. イメージをプライベートイメージリポジトリに同期してください。
   同期方法: [プライベートレジストリへのイメージ同期](/versions/3-0-x/ja-jp/deployment/advanced-configuration/container-registry#syncing-images-to-a-private-registry)。

