---
title: 内部ユーザー認証
---

内部ユーザーとは、Dify エンタープライズ版のワークスペース内で登録されたメンバーまたは管理バックエンドから追加されたメンバーを指します。アイデンティティ認証メカニズムは、内部ユーザーが認可された後に Dify エンタープライズ版内のリソースにアクセスできることを保証します。

## 認証範囲の概要

Dify エンタープライズ版では、ユーザーロールやアクセスシナリオに応じて異なる認証方式を提供します：

| アクセス対象 | ユーザーロール | 認証方式 | セキュリティレベル |
|-------------|--------------|----------|------------------|
| **ワークスペース** | 企業内部ユーザー | メールアドレス・パスワード、メールアドレス・認証コード、SSO | 高 |
| **Web App** | 企業内部ユーザー、特定グループユーザー | メールアドレス・パスワード、メールアドレス・認証コード、SSO | 中 |

## 認証方式の設定

システム管理者は **管理バックエンド** → **アイデンティティ認証** → **メンバー認証** で、企業内部ユーザーがワークスペースや Web App にログインする際の認証方式を統一管理できます。

![](https://assets-docs.dify.ai/2025/06/6b8cf5d9a048fc463c59bc8b41665d2a.png)

### メールアドレスとパスワード認証

**適用範囲：**
- ワークスペース
- Web App

**機能特徴：**
- 従来のユーザー名・パスワードログイン方式
- 強力なパスワードポリシー設定をサポート
- すべてのユーザータイプに適用

**設定手順：**
1. **アイデンティティ認証** → **メンバー認証** → **メールアドレスとパスワード**
2. 右側のスイッチをクリックしてこの認証方式を有効化

<Tabs>
  <Tab title="管理バックエンド設定">
    <Frame caption="企業管理バックエンドでメールアドレス・パスワード認証を有効化">
      <img src="https://assets-docs.dify.ai/2025/06/6ebe7dbbdc394d94b3f45dbc4b615a1d.png" alt="メールアドレス・パスワード認証設定インターフェース" />
    </Frame>
  </Tab>
  
  <Tab title="ユーザーログインインターフェース">
    <Frame caption="ユーザーログインページ表示">
      <img src="https://assets-docs.dify.ai/2025/04/14e603662ca00daf80762f57a228e57c.png" alt="ユーザーログインインターフェース" />
    </Frame>
  </Tab>
</Tabs>

**パスワードセキュリティ推奨事項：**
- パスワード長を最低8文字に強制設定
- 大文字・小文字・数字・特殊文字を含める
- 定期的にユーザーにパスワード更新を促す
- 一般的な弱いパスワードを禁止

### メールアドレスと認証コード認証

**適用範囲：**
- ワークスペース
- Web App

**機能特徴：**
- パスワードレスログイン方式
- メール認証に基づくワンタイム認証コード
- ユーザーの利便性を向上させ、パスワード管理の負担を軽減

**設定手順：**
1. メールサービスプロバイダーが設定されていることを確認
2. **アイデンティティ認証** → **メンバー認証** ページで「メールアドレスと認証コード」を有効化
3. 認証コードパラメータを設定：
   - 認証コード有効期限（推奨5-10分）
   - 送信頻度制限
   - 認証コードの文字数とタイプ

<Tabs>
  <Tab title="管理バックエンド設定">
    <Frame caption="企業管理バックエンドでメールアドレス・認証コード認証を有効化">
      <img src="https://assets-docs.dify.ai/2025/06/7729d5b4e299f11f089c0d73045308e1.png" alt="メールアドレス・認証コード認証設定インターフェース" />
    </Frame>
  </Tab>
  
  <Tab title="ユーザーログインインターフェース">
    <Frame caption="認証コードログインページ">
      <img src="https://assets-docs.dify.ai/2025/04/2572a20174e7b9fa85817dca02bba937.png" alt="認証コードログインインターフェース" />
    </Frame>
  </Tab>
</Tabs>

**前提条件：**
- SMTP メールサービスが設定済み
- メールサービスが安定して利用可能
- 有効なユーザーメールアドレス

### シングルサインオン（SSO）

**適用範囲：**
- ワークスペース
- Web App

**機能特徴：**
- 企業の既存アイデンティティシステムとの統合
- OIDC、SAML、OAuth2 プロトコルをサポート
- 統一された企業アイデンティティ管理
- 自動ユーザー同期をサポート

**設定手順：**
1. **アイデンティティ認証** → **メンバー認証** ページで「シングルサインオン（SSO）」を有効化
2. アイデンティティプロバイダー情報を設定
3. ユーザー属性マッピングを設定
4. SSO 接続をテスト

<Tabs>
  <Tab title="管理バックエンド設定">
    <Frame caption="企業管理バックエンドで SSO 認証を有効化">
      <img src="https://assets-docs.dify.ai/2025/06/b8e0836b5179a4127d611926f9a1a34d.png" alt="SSO 認証設定インターフェース" />
    </Frame>
  </Tab>
  
  <Tab title="ユーザーログインインターフェース">
    <Frame caption="SSO ログインページ">
      <img src="https://assets-docs.dify.ai/2025/04/32db3fc352c7ba40eb4343fd5f6229e5.png" alt="SSO ログインインターフェース" />
    </Frame>
  </Tab>
</Tabs>

<Warning>
SSO を設定する際は、アイデンティティプロバイダーでコールバックアドレスを正しく設定する必要があります。ワークスペースと Web App の**コールバックアドレスは異なります**のでご注意ください。
</Warning>

詳細な SSO 設定手順については、[エンタープライズ SSO 設定ガイド](/ja-jp/administrator-guide/sso/introduction)をご参照ください。

## アクセス権限管理

### ワークスペース

システム管理者は **システム設定** → **アイデンティティ認証** → **メンバー認証** で、メールアドレス・パスワード認証、メールアドレス・認証コード認証、シングルサインオン（SSO）認証方式を有効化できます。

![](https://assets-docs.dify.ai/2025/06/6b8cf5d9a048fc463c59bc8b41665d2a.png)

ユーザーが Dify エンタープライズ版ワークスペースにアクセスする際、設定に応じて対応するアイデンティティ認証プロンプトが表示され、認証後にアクセスが許可されます。

**ユーザー登録の仕組み：**

以下はエンタープライズ版で採用しているユーザー登録の仕組みです：

<Tabs>
  <Tab title="オープン登録モード">
    **設定：**
    - 「ユーザーが自分でアカウントを登録することを許可」を有効化
    - 「システムが自動的に個人スペースを作成することを許可」を有効化
    
    **特徴：**
    - ユーザーが自主的に登録してすぐに使用可能
    - システムが自動的に個人ワークスペースを割り当て
    - オープンな企業環境に適している
  </Tab>
  
  <Tab title="招待登録モード">
    **設定：**
    - 「ユーザーが自分でアカウントを登録することを許可」を無効化
    - 「システムが自動的に個人スペースを作成することを許可」を有効化
    
    **特徴：**
    - 管理者が招待したユーザーのみ登録可能
    - 登録後に自動的に個人スペースを作成
    - 制御された企業環境に適している
  </Tab>
  
  <Tab title="完全制御モード">
    **設定：**
    - 「ユーザーが自分でアカウントを登録することを許可」を無効化
    - 「システムが自動的に個人スペースを作成することを許可」を無効化
    
    **特徴：**
    - すべての操作で管理者の手動処理が必要
    - 最高レベルのセキュリティ
    - 高度に機密性の高い企業環境に適している
  </Tab>
</Tabs>

### Web App

Web App の公開権限が **プラットフォーム内全メンバー** または **プラットフォーム内指定グループ** に設定されている場合、Web App にアクセスする際、システム管理者が「内部ユーザー認証」設定ページで有効化した認証方式（メールアドレス・パスワード、メールアドレス・認証コード、または SSO）が自動的に有効になります。ユーザーが Dify エンタープライズ版メンバーリストに含まれていない場合、アクセスできない旨が表示されます。

## セキュリティベストプラクティス

### 認証戦略の推奨事項

**複数の認証方式を有効化**

- 統一アイデンティティ管理のために主に SSO を使用
- バックアップ方式としてメールアドレス・パスワードを保持
- 緊急アクセス用にメールアドレス・認証コードを使用

### セッション管理

**セッションセキュリティ設定：**

- **セッションタイムアウト**：セキュリティ要件に基づいて7-30日を推奨
- **同時ログイン制限**：同一アカウントの並行ログイン数を制限
- **IP アドレスバインディング**：高セキュリティ要件下で IP ホワイトリストを有効化

### パスワードポリシー

**強力なパスワード要件：**

- 最低8文字、12文字以上を推奨
- 大文字・小文字・数字・特殊文字を含む
- 一般的な弱いパスワードや辞書語を禁止
- 定期的な強制パスワード更新（90-180日）

## トラブルシューティング

### よくある問題

<Accordion title="Web App にアクセスする際、アクセス権限なしと表示される">
**考えられる原因：**
- SSO 設定が有効化されていない
- アイデンティティプロバイダー設定エラー
- ネットワーク接続問題

**解決方法：**
システム管理者に連絡して **システム設定** → **アイデンティティ認証** → **Web App 外部ユーザー認証** で SSO 認証が正しく設定・有効化されているかを確認してください。
</Accordion>

<Accordion title="ユーザーがログインできず、'Authentication method not configured' と表示される">
**原因分析：**
システム管理者が認証方式を有効化していない、またはすべての認証方式が無効化されています。

**解決方法：**
1. **アイデンティティ認証** → **メンバー認証** 設定を確認
2. 少なくとも1つの認証方式を有効化
3. メールサービス設定が正常であることを確認（メールアドレス認証コードを使用する場合）
4. SSO 接続状態をテスト（SSO を使用する場合）
</Accordion>

<Accordion title="メールアドレス認証コードが送信または受信できない">
**考えられる原因：**
- SMTP メールサービス設定エラー
- メールサーバー接続問題
- 無効なユーザーメールアドレス
- スパムメールフィルタリング

**解決方法：**
1. SMTP サーバー設定と接続状態を確認
2. メールサーバー認証情報を検証
3. ユーザーメールアドレスの有効性を確認
4. ユーザーにスパムフォルダーの確認を促す
5. メールサービスプロバイダーに連絡してサービス状態を確認
</Accordion>

<Accordion title="SSO ログインが失敗またはリダイレクトできない">
**考えられる原因：**
- アイデンティティプロバイダー設定エラー
- コールバックアドレス設定が正しくない
- アイデンティティプロバイダーでのユーザー権限不足
- ネットワーク接続問題

**解決方法：**
1. アイデンティティプロバイダーの設定情報を確認
2. コールバックアドレスの正確性を検証
3. アイデンティティプロバイダーでのユーザー状態と権限を確認
4. アイデンティティプロバイダーとのネットワーク接続をテスト
5. システムログで詳細なエラー情報を確認
</Accordion>

企業ユーザー認証を適切に設定することで、セキュリティを確保しながら、企業ユーザーに便利な AI アプリケーション使用体験を提供できます。企業の具体的なセキュリティ要件とユーザー規模に基づいて、適切な認証戦略の組み合わせを選択することをお勧めします。
