---
title: WebApp 外部ユーザー認証
version: '日本語'
---

この認証方式は、公開権限が「認証済み外部ユーザー」に設定された Web App に適用されます。外部ユーザーは Dify エンタープライズアカウントを登録する必要がなく、認証後に Web App にアクセスできます。

> 外部ユーザーとは、Dify エンタープライズシステムに参加していないメンバーを指します。

企業にとって、この認証方式を有効化することで、アプリケーションアクセスを制限するだけでなく、サードパーティのアイデンティティプロバイダーを通じて外部ユーザーを監視・管理することも可能になります。

**使用ケース**

少数の IT 担当者が企業内部の従業員向けに AI アシスタントを構築したが、すべてのメンバーが Dify エンタープライズシステムに参加しているわけではない。しかし、全員がサードパーティのアイデンティティプロバイダーのメンバーリストに登録されている。この場合、Web App 外部ユーザー認証を有効化することで、Dify エンタープライズシステム外のユーザーも認証後にアクセスできるようになります。

この認証方式は、顧客、パートナー、またはその他の外部ユーザーに AI サービスを提供するシナリオに適しています。

## 認証プロセス

<Steps>
  <Step title="ユーザーアクセス">
    ユーザーがブラウザを通じて Web アプリケーションリンクにアクセス
  </Step>
  <Step title="自動リダイレクト">
    システムが自動的にユーザーを設定済みの SSO ログインページにリダイレクト
  </Step>
  <Step title="アイデンティティ認証">
    ユーザーがサードパーティのアイデンティティプロバイダーでアイデンティティ認証を完了
  </Step>
  <Step title="認可コールバック">
    認証成功後、システムがユーザーをアプリケーションにリダイレクト
  </Step>
  <Step title="使用開始">
    ユーザーが直接 Web App インターフェースに入り、サービスの使用を開始
  </Step>
</Steps>

## 設定手順

### 前提条件

設定を開始する前に、以下を確認してください：
- Dify エンタープライズがデプロイ済み
- システム管理者権限を持っている
- サードパーティ SSO アイデンティティプロバイダーが準備済み

### ステップ 1：SSO アイデンティティプロバイダーを設定

1. **Dify エンタープライズ管理バックエンド** にログイン
2. **アイデンティティ認証** → **Web App 外部ユーザー** に移動
3. 「SSO アイデンティティプロバイダー」エリアの **設定** ボタンをクリック

<Frame>
  <img src="https://assets-docs.dify.ai/2025/06/a738885cd51b088a2292742d03b6f271.png" alt="Web App 外部ユーザー認証設定インターフェース" />
</Frame>

異なるアイデンティティプロバイダーに応じて設定してください。詳細な手順については、[SSO 認証の設定](/ja-jp/administrator-guide/sso/introduction)をご参照ください。

### ステップ 2：外部ユーザー認証を有効化

1. 設定完了後、**SSO を有効化** スイッチを見つけてください
2. スイッチを **オン** に切り替えてください

<Info>
  SSO が設定されているが認証が有効化されていない場合、Web App 公開権限の **認証済み外部ユーザー** オプションが一時的に無効になります。Web App 公開権限設定の詳細については、[アプリケーションアクセス権限管理](/versions/2-8-x/ja-jp/user-guide/application-publishing/permission-management)をご参照ください。
</Info>

### ステップ 3：認証設定をテスト

1. Web App を公開する際、権限範囲を **認証済み外部ユーザー** に設定
2. Web App URL を外部ユーザーに送信
3. SSO ログインページに正しくリダイレクトされることを確認
4. テストアカウントを使用してログインプロセスを完了
5. Web App に正常にアクセスできることを確認

## よくある問題

<Accordion title="Web App にアクセスする際、アクセス拒否される">
**考えられる原因：**
- SSO 設定が有効化されていない
- アイデンティティプロバイダー設定エラー
- ネットワーク接続問題

**解決方法：**
1. システム管理者に連絡して **システム設定** → **アイデンティティ認証** → **Web App 外部ユーザー認証** で SSO 認証が正しく設定・有効化されているかを確認してください。
2. ユーザーがサードパーティのアイデンティティプロバイダーのメンバーリストに追加されていることを確認してください。
</Accordion>

<Accordion title="SSO ログインページにリダイレクトできない">
**考えられる原因：**
- SSO 設定が有効化されていない
- アイデンティティプロバイダー設定エラー
- ネットワーク接続問題

**解決方法：**
1. SSO が有効化されているかを確認
2. アイデンティティプロバイダーの設定情報を検証
3. ネットワーク接続と DNS 解決をテスト
4. システムエラーログを確認
</Accordion>

<Accordion title="SSO ログイン後に Web App に戻れない">
**考えられる原因：**
- コールバックアドレス設定が正しくない
- トークン認証失敗
- ユーザー権限不足

**解決方法：**
1. アイデンティティプロバイダーのコールバックアドレス設定を確認。**管理バックエンド** → **アイデンティティ認証** → **Web App 外部ユーザー** でコールバックアドレスを取得してください。
2. クライアントシークレットが正しいかを検証
3. アイデンティティプロバイダーでのユーザー権限を確認
</Accordion>

<Accordion title="一部のユーザーが SSO で認証できない">
**考えられる原因：**
- ユーザーアカウントが無効化されている
- 権限グループ設定問題
- 属性マッピングの不一致

**解決方法：**
1. アイデンティティプロバイダーでのユーザー状態を確認
2. ユーザーの組織構造と権限割り当てを検証
3. 属性マッピングルールを調整
</Accordion>
